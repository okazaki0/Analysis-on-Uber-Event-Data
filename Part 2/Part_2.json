{"paragraphs":[{"text":"%spark\nimport org.apache.kafka.clients.consumer.ConsumerRecord\nimport org.apache.kafka.common.serialization.StringDeserializer\nimport org.apache.spark.streaming.kafka010._\nimport org.apache.spark.streaming.kafka010.LocationStrategies.PreferConsistent\nimport org.apache.spark.streaming.kafka010.ConsumerStrategies.Subscribe\nimport org.apache.spark.streaming._\nimport _root_.kafka.serializer.DefaultDecoder\nimport _root_.kafka.serializer.StringDecoder\nimport org.apache.spark.storage.StorageLevel\nimport org.apache.spark.streaming.kafka.KafkaUtils\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.types._W\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql._\nimport org.apache.spark.ml.feature.VectorAssembler\nimport org.apache.spark.ml.clustering.KMeansModel","user":"anonymous","dateUpdated":"2019-02-19T00:08:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.kafka.clients.consumer.ConsumerRecord\nimport org.apache.kafka.common.serialization.StringDeserializer\nimport org.apache.spark.streaming.kafka010._\nimport org.apache.spark.streaming.kafka010.LocationStrategies.PreferConsistent\nimport org.apache.spark.streaming.kafka010.ConsumerStrategies.Subscribe\nimport org.apache.spark.streaming._\nimport _root_.kafka.serializer.DefaultDecoder\nimport _root_.kafka.serializer.StringDecoder\nimport org.apache.spark.storage.StorageLevel\nimport org.apache.spark.streaming.kafka.KafkaUtils\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql._\nimport org.apache.spark.ml.feature.VectorAssembler\nimport org.apache.spark.ml.clustering.KMeansModel\n"}]},"apps":[],"jobName":"paragraph_1550436495514_1347310882","id":"20190217-204815_1998163637","dateCreated":"2019-02-17T20:48:15+0000","dateStarted":"2019-02-18T23:58:48+0000","dateFinished":"2019-02-18T23:58:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:473"},{"text":"%pyspark\nfrom pyspark.mllib.linalg import Vectors\nfrom pyspark.ml.feature import StandardScaler\nfrom pyspark.ml import Pipeline\nfrom pyspark.sql import Row\nfrom pyspark.ml.clustering import KMeans, KMeansModel\nfrom pyspark.ml.tuning import TrainValidationSplit\nfrom pyspark.sql import SQLContext\nfrom pyspark.sql.functions import col, mean\nfrom pyspark.sql.types import *\nfrom pyspark.ml.feature import VectorAssembler\nfrom pyspark.ml.evaluation import ClusteringEvaluator","user":"anonymous","dateUpdated":"2019-02-19T00:29:49+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550536181479_-570767097","id":"20190219-002941_1616265042","dateCreated":"2019-02-19T00:29:41+0000","dateStarted":"2019-02-19T00:29:49+0000","dateFinished":"2019-02-19T00:29:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:474"},{"text":"val model = KMeansModel.load(\"model\")","user":"anonymous","dateUpdated":"2019-02-18T07:19:49+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"model: org.apache.spark.ml.clustering.KMeansModel = KMeans_31d3ba4bba02\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=0","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=1","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=2"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550463099764_1367886685","id":"20190218-041139_334088100","dateCreated":"2019-02-18T04:11:39+0000","dateStarted":"2019-02-18T07:19:49+0000","dateFinished":"2019-02-18T07:20:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:475"},{"text":"case class Center(cid: Integer, clat: Double, clon: Double)   extends Serializable \nvar ac = new Array[Center](8)\nvar index: Int = 0\n model.clusterCenters.foreach(x => {\n    ac(index) = Center(index, x(0), x(1));\n    index += 1;\n    })\n val ccdf = spark.createDataset(ac)\n ccdf.show ","user":"anonymous","dateUpdated":"2019-02-18T07:20:08+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class Center\nac: Array[Center] = Array(null, null, null, null, null, null, null, null)\nindex: Int = 0\nccdf: org.apache.spark.sql.Dataset[Center] = [cid: int, clat: double ... 1 more field]\n+---+------------------+------------------+\n|cid|              clat|              clon|\n+---+------------------+------------------+\n|  0|40.731004063086196|  -73.997821843761|\n|  1| 40.76671785028902|-73.97185792562814|\n|  2| 40.65715454643839| -73.7784502515282|\n|  3|40.759877422009396|-73.87319539537648|\n|  4| 40.70030127111548| -74.2001973574177|\n|  5| 40.77089895150719|-73.46007673656621|\n|  6| 40.68624863582041|-73.96377484246057|\n|  7| 40.88602293520361|-73.89210208311515|\n+---+------------------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1550464118176_1615887724","id":"20190218-042838_1289449521","dateCreated":"2019-02-18T04:28:38+0000","dateStarted":"2019-02-18T07:20:08+0000","dateFinished":"2019-02-18T07:20:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:476"},{"text":"val df1 = spark.readStream.format(\"kafka\").option(\"kafka.bootstrap.servers\", \"ec2-3-88-10-219.compute-1.amazonaws.com:9092\").option(\"subscribe\", \"uber\").option(\"startingOffsets\",\"earliest\").load()","user":"anonymous","dateUpdated":"2019-02-18T07:30:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df1: org.apache.spark.sql.DataFrame = [key: binary, value: binary ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1550449739913_-746039633","id":"20190218-002859_1581911489","dateCreated":"2019-02-18T00:28:59+0000","dateStarted":"2019-02-18T07:29:56+0000","dateFinished":"2019-02-18T07:29:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:477"},{"text":"df1.printSchema()","user":"anonymous","dateUpdated":"2019-02-18T07:20:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- key: binary (nullable = true)\n |-- value: binary (nullable = true)\n |-- topic: string (nullable = true)\n |-- partition: integer (nullable = true)\n |-- offset: long (nullable = true)\n |-- timestamp: timestamp (nullable = true)\n |-- timestampType: integer (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1550462601698_1614115762","id":"20190218-040321_696781199","dateCreated":"2019-02-18T04:03:21+0000","dateStarted":"2019-02-18T07:20:32+0000","dateFinished":"2019-02-18T07:20:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:478"},{"text":"case class Uber(Date: String, Lat: Double, Lon: Double, Base: String)   extends Serializable\n // Parse string into Uber case class\n def parseUber(str: String): Uber = {\n    val p = str.split(\",\")\n    Uber(p(0), p(1).toDouble, p(2).toDouble, p(3))\n }  ","user":"anonymous","dateUpdated":"2019-02-19T00:27:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class Uber\nparseUber: (str: String)Uber\n"}]},"apps":[],"jobName":"paragraph_1550359482187_1775989630","id":"20190216-232442_706617087","dateCreated":"2019-02-16T23:24:42+0000","dateStarted":"2019-02-18T07:20:35+0000","dateFinished":"2019-02-18T07:20:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:479"},{"text":"import spark.implicits._\n\nspark.udf.register(\"deserialize\", \n    (message: String) => parseUber(message))\n\nval df2 = df1.selectExpr(\"\"\"deserialize(CAST(value as STRING)) AS message\"\"\").select($\"message\".as[Uber])  ","user":"anonymous","dateUpdated":"2019-02-18T07:20:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import spark.implicits._\nres14: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StructType(StructField(dt,StringType,true), StructField(lat,DoubleType,false), StructField(lon,DoubleType,false), StructField(base,StringType,true)),Some(List(StringType)))\ndf2: org.apache.spark.sql.Dataset[Uber] = [dt: string, lat: double ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1550464527053_295072260","id":"20190218-043527_864309194","dateCreated":"2019-02-18T04:35:27+0000","dateStarted":"2019-02-18T07:20:39+0000","dateFinished":"2019-02-18T07:20:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:480"},{"text":"val featureCols = Array(\"Lat\", \"Lon\")\nval assembler = new VectorAssembler().setInputCols(featureCols).setOutputCol(\"features\")\nval df3 = assembler.transform(df2)","user":"anonymous","dateUpdated":"2019-02-19T00:27:22+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"featureCols: Array[String] = Array(lat, lon)\nassembler: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_cbbfc7a94e64\ndf3: org.apache.spark.sql.DataFrame = [dt: string, lat: double ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1550463354742_-730318704","id":"20190218-041554_1662911774","dateCreated":"2019-02-18T04:15:54+0000","dateStarted":"2019-02-18T07:20:51+0000","dateFinished":"2019-02-18T07:20:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:481"},{"text":"val streamingquery = df3.writeStream.queryName(\"df3\").format(\"memory\").outputMode(\"append\").start()","user":"anonymous","dateUpdated":"2019-02-19T00:27:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"streamingquery: org.apache.spark.sql.streaming.StreamingQuery = org.apache.spark.sql.execution.streaming.StreamingQueryWrapper@78fa8da6\n"}]},"apps":[],"jobName":"paragraph_1550465698214_1910758652","id":"20190218-045458_1078130040","dateCreated":"2019-02-18T04:54:58+0000","dateStarted":"2019-02-18T07:25:25+0000","dateFinished":"2019-02-18T07:25:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:482"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550537228187_239227409","id":"20190219-004708_1336751328","dateCreated":"2019-02-19T00:47:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2951","text":"%pyspark\ndf = sqlContext.sql(\"SELECT * FROM df3\")","dateUpdated":"2019-02-19T00:48:08+0000","dateFinished":"2019-02-19T00:47:43+0000","dateStarted":"2019-02-19T00:47:43+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\ndf.show()","user":"anonymous","dateUpdated":"2019-02-19T00:48:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+-------+--------+------+------------------+\n|          Date/Time|    Lat|     Lon|  Base|          features|\n+-------------------+-------+--------+------+------------------+\n|2014-08-01 00:00:00|40.7476|-73.9871|B02598|[40.7476,-73.9871]|\n|2014-08-01 00:00:00|40.7424|-74.0044|B02598|[40.7424,-74.0044]|\n|2014-08-01 00:00:00| 40.751|-73.9869|B02598| [40.751,-73.9869]|\n|2014-08-01 00:00:00|40.7406|-73.9902|B02598|[40.7406,-73.9902]|\n|2014-08-01 00:00:00|40.6994|-73.9591|B02617|[40.6994,-73.9591]|\n|2014-08-01 00:00:00|40.6917|-73.9398|B02617|[40.6917,-73.9398]|\n|2014-08-01 00:00:00|40.7063|-73.9223|B02617|[40.7063,-73.9223]|\n|2014-08-01 00:00:00|40.6759|-74.0168|B02617|[40.6759,-74.0168]|\n|2014-08-01 00:00:00|40.7617|-73.9847|B02617|[40.7617,-73.9847]|\n|2014-08-01 00:00:00|40.6969|-73.9064|B02617|[40.6969,-73.9064]|\n|2014-08-01 00:00:00|40.7623|-73.9751|B02617|[40.7623,-73.9751]|\n|2014-08-01 00:00:00|40.6982|-73.9669|B02617|[40.6982,-73.9669]|\n|2014-08-01 00:00:00|40.7553|-73.9253|B02617|[40.7553,-73.9253]|\n|2014-08-01 00:00:00|40.7325|-73.9876|B02682|[40.7325,-73.9876]|\n|2014-08-01 00:00:00|40.6754| -74.017|B02682| [40.6754,-74.017]|\n|2014-08-01 00:00:00|40.7303|-74.0029|B02682|[40.7303,-74.0029]|\n|2014-08-01 00:00:00|40.7218|-73.9973|B02682|[40.7218,-73.9973]|\n|2014-08-01 00:00:00|40.7134|-74.0091|B02682|[40.7134,-74.0091]|\n|2014-08-01 00:00:00|40.7194|-73.9964|B02682|[40.7194,-73.9964]|\n|2014-08-01 00:00:00| 40.762| -73.983|B02682|  [40.762,-73.983]|\n+-------------------+-------+--------+------+------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=76"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550535619318_-1832608137","id":"20190219-002019_1794104272","dateCreated":"2019-02-19T00:20:19+0000","dateStarted":"2019-02-19T00:48:09+0000","dateFinished":"2019-02-19T00:48:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483"},{"text":"%pyspark\ndf_clusters = model.transform(df)\ndf_clusters.show()","user":"anonymous","dateUpdated":"2019-02-19T00:48:35+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+-------+--------+------+------------------+----------+\n|          Date/Time|    Lat|     Lon|  Base|          features|prediction|\n+-------------------+-------+--------+------+------------------+----------+\n|2014-08-01 00:00:00|40.7476|-73.9871|B02598|[40.7476,-73.9871]|         0|\n|2014-08-01 00:00:00|40.7424|-74.0044|B02598|[40.7424,-74.0044]|         0|\n|2014-08-01 00:00:00| 40.751|-73.9869|B02598| [40.751,-73.9869]|         0|\n|2014-08-01 00:00:00|40.7406|-73.9902|B02598|[40.7406,-73.9902]|         0|\n|2014-08-01 00:00:00|40.6994|-73.9591|B02617|[40.6994,-73.9591]|         5|\n|2014-08-01 00:00:00|40.6917|-73.9398|B02617|[40.6917,-73.9398]|         5|\n|2014-08-01 00:00:00|40.7063|-73.9223|B02617|[40.7063,-73.9223]|         5|\n|2014-08-01 00:00:00|40.6759|-74.0168|B02617|[40.6759,-74.0168]|         5|\n|2014-08-01 00:00:00|40.7617|-73.9847|B02617|[40.7617,-73.9847]|         1|\n|2014-08-01 00:00:00|40.6969|-73.9064|B02617|[40.6969,-73.9064]|         5|\n|2014-08-01 00:00:00|40.7623|-73.9751|B02617|[40.7623,-73.9751]|         1|\n|2014-08-01 00:00:00|40.6982|-73.9669|B02617|[40.6982,-73.9669]|         5|\n|2014-08-01 00:00:00|40.7553|-73.9253|B02617|[40.7553,-73.9253]|         1|\n|2014-08-01 00:00:00|40.7325|-73.9876|B02682|[40.7325,-73.9876]|         0|\n|2014-08-01 00:00:00|40.6754| -74.017|B02682| [40.6754,-74.017]|         5|\n|2014-08-01 00:00:00|40.7303|-74.0029|B02682|[40.7303,-74.0029]|         0|\n|2014-08-01 00:00:00|40.7218|-73.9973|B02682|[40.7218,-73.9973]|         0|\n|2014-08-01 00:00:00|40.7134|-74.0091|B02682|[40.7134,-74.0091]|         0|\n|2014-08-01 00:00:00|40.7194|-73.9964|B02682|[40.7194,-73.9964]|         0|\n|2014-08-01 00:00:00| 40.762| -73.983|B02682|  [40.762,-73.983]|         1|\n+-------------------+-------+--------+------+------------------+----------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=77"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550535645601_-1500505072","id":"20190219-002045_212206976","dateCreated":"2019-02-19T00:20:45+0000","dateStarted":"2019-02-19T00:48:35+0000","dateFinished":"2019-02-19T00:48:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:484"},{"text":"%pyspark\ndf_clusters = df_clusters.withColumnRenamed(\"Date/Time\", \"dt\").withColumnRenamed(\"Lat\", \"lat\").withColumnRenamed(\"Lon\", \"lon\")","user":"anonymous","dateUpdated":"2019-02-19T00:54:44+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550537550497_-113878082","id":"20190219-005230_1408511543","dateCreated":"2019-02-19T00:52:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3209","dateFinished":"2019-02-19T00:54:44+0000","dateStarted":"2019-02-19T00:54:44+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nctr = sc.parallelize([['40.73100406', '-73.99782184', '0'],\n                     ['40.76671785', '-73.97185793', '1'],\n                     ['40.65715455', '-73.77845025', '2'],\n                     ['40.75987742', '-73.8731954', '3'],\n                     ['40.70030127', '-74.20019736', '4'],\n                     ['40.77089895', '-73.46007674', '5'],\n                     ['40.68624864', '-73.96377484', '6'],\n                     ['40.88602294', '-73.89210208', '7']]).\\\n    toDF([\"lat\", \"lon\", \"centroid\"])","user":"anonymous","dateUpdated":"2019-02-19T00:14:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=71"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550534692059_-216190910","id":"20190219-000452_1773552830","dateCreated":"2019-02-19T00:04:52+0000","dateStarted":"2019-02-19T00:14:09+0000","dateFinished":"2019-02-19T00:14:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:485"},{"text":"%pyspark\nctr.registerTempTable(\"centroids\")\ndf_clusters.registerTempTable(\"uber\")","user":"anonymous","dateUpdated":"2019-02-19T00:54:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550534715748_388227811","id":"20190219-000515_1101507002","dateCreated":"2019-02-19T00:05:15+0000","dateStarted":"2019-02-19T00:54:51+0000","dateFinished":"2019-02-19T00:54:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:486"},{"text":"%sql\nSELECT lat, lon, centroid \nFROM centroids ","user":"anonymous","dateUpdated":"2019-02-18T08:03:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"zeppelin-leaflet","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"lat":"string","lon":"string","centroid":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"zeppelin-leaflet":{"latitude":{"name":"lat","index":0,"aggr":"sum"},"longitude":{"name":"lon","index":1,"aggr":"sum"},"tooltip":{"name":"centroid","index":2,"aggr":"sum"},"popup":{"name":"centroid","index":2,"aggr":"sum"}}}},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"lat\tlon\tcentroid\n40.73100406\t-73.99782184\t0\n40.76671785\t-73.97185793\t1\n40.65715455\t-73.77845025\t2\n40.75987742\t-73.8731954\t3\n40.70030127\t-74.20019736\t4\n40.77089895\t-73.46007674\t5\n40.68624864\t-73.96377484\t6\n40.88602294\t-73.89210208\t7\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=20","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=21"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550476810922_-1202997756","id":"20190218-080010_111590706","dateCreated":"2019-02-18T08:00:10+0000","dateStarted":"2019-02-18T08:01:42+0000","dateFinished":"2019-02-18T08:01:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:487"},{"text":"%md\nWhat times of the day have the highest demand?\n","user":"anonymous","dateUpdated":"2019-02-18T08:21:59+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>What times of the day have the highest demand?</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1550477969981_-219040986","id":"20190218-081929_397108008","dateCreated":"2019-02-18T08:19:29+0000","dateStarted":"2019-02-18T08:21:59+0000","dateFinished":"2019-02-18T08:21:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:488"},{"text":"%sql\nSELECT hour(dt) ,count(prediction) as count\nFROM uber\nGROUP BY hour(dt)","user":"anonymous","dateUpdated":"2019-02-19T00:55:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"hour(dt)":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"hour(dt)","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"hour(dt)\tcount\n12\t32106\n22\t46008\n1\t14471\n13\t35764\n6\t24907\n16\t53481\n3\t10376\n20\t51674\n5\t16525\n19\t53008\n15\t48197\n9\t30195\n17\t57122\n4\t11774\n8\t34566\n23\t33609\n7\t34064\n10\t30706\n21\t51354\n11\t31778\n14\t40644\n2\t10105\n0\t21450\n18\t55390\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=78","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=79","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=80","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=81","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=82"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550477079559_-419679204","id":"20190218-080439_575263362","dateCreated":"2019-02-18T08:04:39+0000","dateStarted":"2019-02-19T00:55:16+0000","dateFinished":"2019-02-19T00:55:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:489"},{"text":"%md\nWhen are the busy hours by cluster?","user":"anonymous","dateUpdated":"2019-02-18T08:22:30+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>When are the busy hours by cluster?</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1550478127141_1588815905","id":"20190218-082207_1690379614","dateCreated":"2019-02-18T08:22:07+0000","dateStarted":"2019-02-18T08:22:30+0000","dateFinished":"2019-02-18T08:22:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:490"},{"text":"%sql\nSELECT hour(dt) AS hr, prediction, count(prediction) AS count \nFROM uber \nGROUP BY hour(dt), prediction","user":"anonymous","dateUpdated":"2019-02-19T00:45:24+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"_id","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"dt","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"lat","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"lon","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"base","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"cid","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"clat","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"clon","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"hr":"string","prediction":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"hr","index":0,"aggr":"sum"}],"groups":[{"name":"prediction","index":1,"aggr":"sum"}],"values":[{"name":"count","index":2,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"hr\tprediction\tcount\n10\t2\t664\n23\t6\t6291\n16\t3\t2210\n17\t1\t21042\n17\t2\t1363\n1\t0\t7260\n6\t1\t8733\n3\t1\t2967\n17\t3\t2413\n7\t4\t248\n2\t2\t146\n18\t1\t20224\n22\t6\t7555\n9\t4\t240\n8\t3\t1606\n12\t7\t697\n19\t2\t1797\n20\t2\t1846\n1\t7\t234\n2\t3\t293\n4\t7\t255\n7\t1\t13376\n11\t6\t4810\n12\t2\t959\n1\t2\t196\n16\t2\t1568\n13\t7\t710\n0\t7\t355\n11\t1\t11576\n9\t1\t11144\n6\t0\t8978\n23\t0\t15354\n4\t0\t4262\n17\t7\t762\n15\t1\t17765\n0\t5\t72\n23\t2\t1499\n5\t7\t323\n15\t5\t124\n5\t6\t3383\n12\t1\t11518\n16\t0\t21978\n15\t6\t5492\n14\t3\t1855\n10\t5\t108\n16\t4\t577\n1\t1\t3133\n9\t7\t535\n6\t5\t29\n1\t3\t397\n20\t3\t2701\n11\t4\t389\n10\t6\t4666\n19\t1\t18479\n11\t7\t718\n21\t5\t148\n3\t5\t13\n13\t5\t125\n15\t2\t1728\n2\t5\t26\n21\t6\t7792\n0\t0\t10079\n7\t2\t781\n17\t6\t6878\n1\t4\t145\n14\t2\t2036\n5\t4\t209\n12\t5\t116\n21\t3\t2815\n23\t3\t1137\n14\t4\t489\n21\t2\t1876\n10\t4\t296\n7\t3\t1329\n10\t1\t11377\n11\t5\t85\n19\t4\t558\n3\t3\t390\n15\t7\t871\n23\t5\t107\n9\t3\t1836\n9\t2\t590\n21\t4\t505\n16\t7\t783\n8\t5\t71\n8\t1\t13213\n13\t4\t467\n21\t7\t945\n4\t3\t477\n22\t0\t20335\n6\t7\t447\n2\t1\t2146\n14\t6\t5203\n18\t6\t7142\n2\t4\t55\n14\t0\t15999\n11\t3\t1703\n18\t5\t150\n4\t6\t2423\n20\t5\t96\n21\t0\t21877\n6\t3\t951\n12\t0\t12383\n13\t3\t1837\n19\t6\t7115\n8\t7\t479\n3\t6\t2207\n8\t2\t467\n7\t5\t55\n13\t6\t4913\n6\t2\t1252\n16\t1\t20364\n9\t5\t81\n16\t6\t5860\n23\t7\t559\n18\t0\t22829\n12\t4\t378\n19\t7\t654\n0\t1\t4995\n2\t0\t4974\n11\t0\t11779\n17\t4\t504\n21\t1\t15396\n18\t2\t1461\n20\t0\t21252\n20\t7\t826\n18\t4\t504\n20\t1\t16988\n13\t0\t13783\n22\t7\t755\n8\t4\t215\n18\t7\t627\n13\t2\t1234\n10\t3\t1885\n5\t0\t5520\n15\t4\t598\n3\t2\t133\n1\t5\t45\n5\t2\t1157\n15\t3\t2257\n5\t1\t5216\n8\t0\t13512\n14\t7\t787\n5\t3\t697\n9\t0\t10819\n20\t4\t532\n23\t4\t427\n0\t6\t4586\n19\t3\t2501\n12\t6\t4484\n18\t3\t2453\n0\t2\t558\n7\t7\t499\n23\t1\t8235\n3\t4\t66\n4\t2\t732\n19\t5\t131\n14\t1\t14156\n22\t5\t126\n4\t4\t213\n11\t2\t718\n17\t5\t168\n6\t6\t4288\n8\t6\t5003\n0\t3\t563\n10\t7\t601\n3\t0\t4372\n20\t6\t7433\n1\t6\t3061\n9\t6\t4950\n10\t0\t11109\n4\t1\t3383\n14\t5\t119\n3\t7\t228\n13\t1\t12695\n19\t0\t21773\n0\t4\t242\n16\t5\t141\n2\t7\t179\n12\t3\t1571\n22\t2\t1737\n17\t0\t23992\n4\t5\t29\n22\t4\t512\n5\t5\t20\n15\t0\t19362\n7\t0\t12626\n7\t6\t5150\n22\t1\t12604\n22\t3\t2384\n6\t4\t229\n2\t6\t2286\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=27","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=28","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=29","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=30","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=31"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550465969726_-272006554","id":"20190218-045929_46179240","dateCreated":"2019-02-18T04:59:29+0000","dateStarted":"2019-02-18T08:08:39+0000","dateFinished":"2019-02-18T08:09:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:491"},{"text":"%md\nHow many pickups occured in each cluster?","user":"anonymous","dateUpdated":"2019-02-18T08:23:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>How many pickups occured in each cluster?</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1550478157026_995137753","id":"20190218-082237_1985305569","dateCreated":"2019-02-18T08:22:37+0000","dateStarted":"2019-02-18T08:23:02+0000","dateFinished":"2019-02-18T08:23:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:492"},{"text":"%sql\nSELECT COUNT(prediction) AS count, prediction\nFROM uber\nGROUP BY prediction\nORDER BY COUNT(prediction) DESC","user":"anonymous","dateUpdated":"2019-02-19T00:45:24+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"count":"string","prediction":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"prediction","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":0,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count\tprediction\n336207\t0\n280725\t1\n122971\t6\n38261\t3\n26498\t2\n13829\t7\n8598\t4\n2185\t5\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=32"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550477598685_-1085153208","id":"20190218-081318_1138386265","dateCreated":"2019-02-18T08:13:18+0000","dateStarted":"2019-02-18T08:13:32+0000","dateFinished":"2019-02-18T08:13:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:493"}],"name":"Spark Streaming + Analysis","id":"2E5Q5U3EJ","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}